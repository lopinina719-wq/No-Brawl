<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KEDZI BRAWL v9.8.2 - MEGA VFX</title>
</head>
<body id="main-body" style="margin:0; background:#000; color:#fff; font-family: 'Arial Black', sans-serif; text-align:center; overflow:hidden; user-select:none; transition: background 0.3s;">

    <style>
        @keyframes rainbow { 0% { background: #ff0000; } 20% { background: #ffcc00; } 40% { background: #00ff00; } 60% { background: #00ffff; } 80% { background: #0000ff; } 100% { background: #ff00ff; } }
        .rainbow-bg { animation: rainbow 2s infinite linear !important; color: #fff; text-shadow: 2px 2px #000; }
        @keyframes glow { 0% { text-shadow: 0 0 5px #f1c40f; } 50% { text-shadow: 0 0 20px #f1c40f, 0 0 30px #ffcc00; } 100% { text-shadow: 0 0 5px #f1c40f; } }
        .lucky-glow { animation: glow 1.5s infinite; color: #f1c40f !important; }
        .window { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.98); z-index:100; padding:15px; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .content { background:#1a1a1a; padding:20px; border-radius:25px; border:3px solid #ffcc00; box-shadow: 0 0 20px rgba(255,204,0,0.2); }
        .opt-btn { background:#333; color:white; border:2px solid #444; padding:15px; width:100%; margin:8px 0; border-radius:12px; display:flex; justify-content:space-between; align-items:center; cursor:pointer; font-weight:bold; }
        .win-flash { background: #004400 !important; }
        .lose-flash { background: #440000 !important; }
    </style>

    <div style="background:linear-gradient(180deg, #222, #111); padding:15px; display:flex; justify-content:space-between; border-bottom:3px solid #ffcc00;">
        <div style="text-align:left;">
            <div id="p-nick" style="color:#ffcc00; font-size:18px;">–ì—Ä–∞–≤–µ—Ü—å</div>
            <div id="p-title" style="font-size:10px; color:#00ff00; font-weight:bold; letter-spacing:1px;">–ù–£–ë–Ü–ö</div>
        </div>
        <div style="text-align:right;">
            <div id="p-trophies-cont" style="color:#ffcc00; font-size:20px;">üèÜ <span id="trophies">0</span></div>
            <div id="quest-info" style="font-size:9px; color:#555;">–ö–í–ï–°–¢: <span id="q-val">0</span>/3 –ü–ï–†–ï–ú–û–ì</div>
        </div>
    </div>

    <div style="padding:25px;">
        <h1 style="color:#ffcc00; font-size:32px; text-shadow: 2px 2px #000; margin-bottom:10px;">KEDZI BRAWL</h1>
        
        <button onclick="startBattle()" id="play-btn" style="background:linear-gradient(#ffdd00, #ffcc00); width:100%; padding:22px; font-size:28px; border:none; border-radius:20px; font-weight:bold; color:#000; box-shadow: 0 6px #b39200; margin-bottom:20px; cursor:pointer;">–ì–†–ê–¢–ò</button>
        
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
            <button onclick="openWin('win-modes')" style="background:#2ecc71; padding:18px; border-radius:15px; border:none; font-weight:bold; color:#000;">–†–ï–ñ–ò–ú–ò</button>
            <button onclick="openWin('win-brawlers')" style="background:#3498db; padding:18px; border-radius:15px; border:none; color:#fff; font-weight:bold;">–ì–ï–†–û–á</button>
            <button onclick="openWin('win-shop')" style="background:#e74c3c; padding:18px; border-radius:15px; border:none; color:#fff; font-weight:bold; grid-column: span 2;">–ú–ê–ì–ê–ó–ò–ù –¢–ê –ë–û–ù–£–°–ò</button>
            <button onclick="openStarrDrop()" id="btn-drop" style="background:#8e44ad; padding:22px; border-radius:15px; border:none; color:#fff; font-weight:bold; grid-column: span 2; font-size:18px; box-shadow: 0 4px #5e2d73;">–°–¢–ê–† –î–†–û–ü (15 üèÜ)</button>
        </div>
        
        <button onclick="openWin('win-promo')" style="margin-top:15px; background:none; border:1px solid #333; color:#555; padding:5px 15px; border-radius:20px; font-size:12px;">–ü–†–û–ú–û–ö–û–î</button>
    </div>

    <div id="win-drop" class="window">
        <h1 id="drop-rarity" style="margin-top:50px; font-size:45px; transition: 0.2s;">RARE</h1>
        <div id="drop-box" onclick="tapDrop()" style="width:190px; height:190px; background:#fff; margin:30px auto; border:10px solid #fff; border-radius:50px; font-size:100px; display:flex; align-items:center; justify-content:center; cursor:pointer; transition: 0.1s; box-shadow: 0 0 40px rgba(255,255,255,0.1);">‚≠ê</div>
        <p id="drop-taps" style="font-size:20px; font-weight:bold;">–¢–ê–ü–ê–ô! (4)</p>
    </div>

    <div id="win-shop" class="window"><div class="content"><h2>–ú–ê–ì–ê–ó–ò–ù</h2><div id="shop-items"></div><button onclick="closeWin('win-shop')" style="background:#444; color:#fff; border:none; padding:15px; width:100%; border-radius:12px; margin-top:10px;">–ó–ê–ö–†–ò–¢–ò</button></div></div>
    <div id="win-modes" class="window"><div class="content"><h2>–†–ï–ñ–ò–ú–ò</h2><div id="modes-list"></div><button onclick="closeWin('win-modes')" style="background:#444; border:none; padding:15px; width:100%; border-radius:12px; color:#fff; margin-top:10px;">–ù–ê–ó–ê–î</button></div></div>
    <div id="win-brawlers" class="window"><div class="content"><h2>–ì–ï–†–û–á</h2><div id="brawlers-list" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;"></div><button onclick="closeWin('win-brawlers')" style="background:#444; border:none; padding:15px; width:100%; border-radius:12px; color:#fff; margin-top:10px;">–ó–ê–ö–†–ò–¢–ò</button></div></div>
    <div id="win-promo" class="window"><div class="content"><h2>–ö–û–î</h2><input type="text" id="promo-in" style="width:80%; padding:15px; border-radius:10px; font-size:20px; text-align:center;"><button onclick="usePromo()" style="background:#2ecc71; border:none; padding:15px; width:100%; border-radius:12px; margin-top:10px; font-weight:bold;">–û–ö</button><button onclick="closeWin('win-promo')" style="background:none; border:none; color:#888; margin-top:10px;">–°–∫–∞—Å—É–≤–∞—Ç–∏</button></div></div>

    <script>
        let trophies = 0, selected = "shelly", curMode = {t:1000, n:'–°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ', isBall: false};
        let dropData = {taps:4, rarityIdx:0}, cheatActive = false, usedPromos = [];
        let hasLuckyRoller = false, hasPiggyBank = false, questWins = 0;

        const brawlers = {
            "shelly":{n:"Shelly",ow:true,c:0.55},"nita":{n:"Nita",ow:false,c:0.58},
            "edgar":{n:"Edgar",ow:false,c:0.75},"moe":{n:"Moe",ow:false,c:0.86},
            "kenji":{n:"Kenji",ow:false,c:0.91},"kedzi":{n:"Kedzi",ow:false,c:0.95}
        };

        const rarities = [
            {n:"RARE", c:"#00ff00", b:20}, {n:"SUPER RARE", c:"#3498db", b:40},
            {n:"EPIC", c:"#9b59b6", b:80}, {n:"MYTHIC", c:"#ff0000", b:150},
            {n:"LEGENDARY", c:"#f1c40f", b:300}, {n:"ULTRA", c:"#ffffff", b:1000}
        ];

        function updateUI() {
            document.getElementById('trophies').innerText = trophies;
            document.getElementById('q-val').innerText = questWins;
            document.getElementById('selected-name').innerText = brawlers[selected].n.toUpperCase();
            
            let nick = document.getElementById('p-nick');
            let trop = document.getElementById('p-trophies-cont');
            if(hasLuckyRoller) {
                nick.classList.add('lucky-glow');
                trop.classList.add('lucky-glow');
            }
            
            let title = "–ù–£–ë–Ü–ö";
            if(trophies > 100) title = "–ë–†–ê–í–õ–ï–†";
            if(trophies > 1000) title = "–õ–ï–ì–ï–ù–î–ê";
            if(hasLuckyRoller) title = "LUCKY ROLLER üé∞";
            if(trophies > 5000) title = "–ë–û–ì –ö–ï–î–ó–Ü";
            document.getElementById('p-title').innerText = title;
        }

        function startBattle() {
            const btn = document.getElementById('play-btn');
            const body = document.getElementById('main-body');
            btn.disabled = true;
            
            setTimeout(() => {
                let win = (cheatActive || curMode.isBall) ? true : (Math.random() < brawlers[selected].c);
                let gain = curMode.isBall ? 5 : 8;
                if(hasPiggyBank && win) gain += 2;
                
                if(win) {
                    trophies += gain; questWins++;
                    body.classList.add('win-flash');
                    if(questWins >= 3) {
                        questWins = 0; trophies += 15;
                        alert("–ö–í–ï–°–¢ –í–ò–ö–û–ù–ê–ù–û! +15üèÜ (–ë–æ–Ω—É—Å –°—Ç–∞—Ä –î—Ä–æ–ø)");
                    }
                } else {
                    trophies = Math.max(0, trophies - 7);
                    body.classList.add('lose-flash');
                }
                
                setTimeout(()=> body.className = "", 300);
                cheatActive = false; updateUI(); btn.disabled = false; saveData();
            }, 800);
        }

        function tapDrop() {
            const box = document.getElementById('drop-box');
            if(dropData.taps > 1) {
                dropData.taps--;
                let chance = hasLuckyRoller ? 0.55 : 0.45;
                if(dropData.rarityIdx >= 4) chance = 0.03; 
                if(Math.random() < chance) dropData.rarityIdx = Math.min(dropData.rarityIdx + 1, 5);
                updateDropUI();
                box.style.transform = "scale(1.2) rotate(5deg)";
                setTimeout(()=>box.style.transform="scale(1) rotate(0deg)", 80);
            } else finishDrop();
        }

        function updateDropUI() {
            const r = rarities[dropData.rarityIdx];
            const rb = document.getElementById('drop-rarity');
            rb.innerText = r.n; rb.style.color = r.c;
            document.getElementById('drop-box').style.borderColor = r.c;
            document.getElementById('drop-taps').innerText = "–¢–ê–ü–ê–ô! (" + dropData.taps + ")";
            document.getElementById('drop-box').className = (r.n === "ULTRA") ? "rainbow-bg" : "";
        }

        function finishDrop() {
            let r = rarities[dropData.rarityIdx];
            trophies += r.b; alert("–û–¢–†–ò–ú–ê–ù–û: " + r.n + " (+" + r.b + " üèÜ)");
            updateUI(); closeWin('win-drop'); saveData();
        }

        function openStarrDrop() {
            if(trophies >= 15) { trophies -= 15; dropData = {taps:4, rarityIdx:0}; updateDropUI(); openWin('win-drop'); updateUI(); }
            else alert("–¢—Ä–µ–±–∞ 15 üèÜ!");
        }

        function openWin(id) { 
            document.getElementById(id).style.display = 'block'; 
            if(id==='win-shop') {
                let h = "";
                if(!hasLuckyRoller) h += '<div class="opt-btn" onclick="buyItem(\'lucky\',5000)"><span>üé∞ Lucky Roller (—à–∞–Ω—Å 55%)</span><span>5000üèÜ</span></div>';
                if(!hasPiggyBank) h += '<div class="opt-btn" onclick="buyItem(\'pig\',7500)"><span>üê∑ –ú–µ–≥–∞ –ö–æ–ø–∏–ª–∫–∞ (+2)</span><span>7500üèÜ</span></div>';
                h += '<div class="opt-btn" onclick="buyItem(\'cheat\',1350)"><span>‚ú® –ú–∞–≥—ñ—è Win</span><span>1350üèÜ</span></div>';
                document.getElementById('shop-items').innerHTML = h;
            }
            if(id==='win-modes') {
                document.getElementById('modes-list').innerHTML = `
                    <button class="opt-btn" onclick="setMode(800,'üöÄ –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ')"><span>üöÄ –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ</span><span>+8üèÜ</span></button>
                    <button class="opt-btn" onclick="setMode(800,'‚öΩ –ë—Ä–∞–≤–ª –ë–æ–ª')"><span>‚öΩ –ë—Ä–∞–≤–ª –ë–æ–ª</span><span>+5üèÜ</span></button>
                `;
            }
            if(id==='win-brawlers') {
                const l = document.getElementById('brawlers-list'); l.innerHTML = "";
                for(let id in brawlers) if(brawlers[id].ow) l.innerHTML += `<div style="background:#444; padding:15px; border-radius:10px;" onclick="selectB('${id}')">${brawlers[id].n}</div>`;
            }
        }
        function buyItem(t, p) { if(trophies>=p){ trophies-=p; if(t==='lucky')hasLuckyRoller=true; if(t==='pig')hasPiggyBank=true; if(t==='cheat')cheatActive=true; updateUI(); saveData(); alert("–£–°–ü–Ü–®–ù–û!"); closeWin('win-shop'); } }
        function usePromo() {
            const v = document.getElementById('promo-in').value.toUpperCase().trim();
            if(usedPromos.includes(v)) return alert("–í–∂–µ –±—É–≤!");
            if(v === 'ARTEMKO') { trophies += 1100; usedPromos.push(v); alert("+1100 üèÜ"); }
            else if(v === 'KEDZI') { brawlers["kedzi"].ow = true; usedPromos.push(v); alert("–í–Ü–î–ö–†–ò–¢–û SECRET KEDZI!"); }
            updateUI(); saveData(); closeWin('win-promo');
        }
        function selectB(id) { selected=id; updateUI(); closeWin('win-brawlers'); saveData(); }
        function closeWin(id) { document.getElementById(id).style.display = 'none'; }
        function setMode(t, n) { curMode = {t, n, isBall: (n.includes('–ë–æ–ª'))}; document.getElementById('cur-mode-txt').innerText = n; closeWin('win-modes'); }
        
        function saveData() { localStorage.setItem('kedzi_save_v6', JSON.stringify({ trophies, selected, usedPromos, hasLuckyRoller, hasPiggyBank, questWins, owned: Object.keys(brawlers).filter(id => brawlers[id].ow) })); }
        function loadData() { 
            let s = JSON.parse(localStorage.getItem('kedzi_save_v6')); 
            if(s){ trophies=s.trophies; selected=s.selected; usedPromos=s.usedPromos || []; hasLuckyRoller=s.hasLuckyRoller; hasPiggyBank=s.hasPiggyBank; questWins=s.questWins||0; if(s.owned) s.owned.forEach(id=> {if(brawlers[id]) brawlers[id].ow=true}); updateUI(); }
            else { updateUI(); }
        }
        window.onload = loadData;
    </script>
</body>
</html>
