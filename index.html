<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KEDZI BRAWL v8.0</title>
</head>
<body style="margin:0; background:#000; color:#fff; font-family: 'Arial Black', sans-serif; text-align:center; overflow:hidden;">

    <div onclick="openWin('win-profile')" style="background:#111; padding:12px; display:flex; justify-content:space-between; border-bottom:2px solid #ffcc00; cursor:pointer;">
        <div style="display:flex; align-items:center; gap:10px;">
            <div id="p-icon" style="font-size:24px;">üë§</div>
            <div style="text-align:left;">
                <div id="p-nick" style="color:#ffcc00; font-size:16px;">–ì—Ä–∞–≤–µ—Ü—å</div>
                <div id="p-rank" style="font-size:10px; color:#aaa;">–û–¥–∏–Ω–æ–∫–∏–π –≥–æ–Ω—â–∏–∫</div>
            </div>
        </div>
        <div style="text-align:right;">
            <div style="color:#ffcc00;">üèÜ <span id="trophies">0</span></div>
            <div id="selected-name" style="font-size:10px; color:#aaa;">SHELLY</div>
        </div>
    </div>

    <div style="padding:20px;">
        <h1 style="color:#ffcc00; font-size:28px; text-shadow: 2px 2px #444;">KEDZI BRAWL v8</h1>
        <div style="background:#222; padding:8px; border-radius:10px; margin-bottom:15px; border: 1px solid #333;">
            –†–ï–ñ–ò–ú: <span id="cur-mode-txt" style="color:#00ff00;">–°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ</span>
        </div>

        <button onclick="startBattle()" id="play-btn" style="background:#ffcc00; width:100%; padding:20px; font-size:24px; border:none; border-radius:20px; font-weight:bold; color:#000; margin-bottom:15px; cursor:pointer;">–ì–†–ê–¢–ò</button>
        
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
            <button onclick="openWin('win-modes')" style="background:#2ecc71; padding:15px; border-radius:12px; border:none; color:#000; font-weight:bold; grid-column: span 2;">–û–ë–†–ê–¢–ò –†–ï–ñ–ò–ú</button>
            <button onclick="openWin('win-brawlers')" style="background:#3498db; padding:15px; border-radius:12px; border:none; color:#fff; font-weight:bold;">–ë–†–ê–í–õ–ï–†–ò</button>
            <button onclick="openWin('win-shop')" style="background:#e74c3c; padding:15px; border-radius:12px; border:none; color:#fff; font-weight:bold;">–ú–ê–ì–ê–ó–ò–ù</button>
            <button onclick="openWin('win-promo')" style="background:#f1c40f; padding:15px; border-radius:12px; border:none; color:#000; font-weight:bold; grid-column: span 2;">–ü–†–û–ú–û–ö–û–î üéÅ</button>
            <button onclick="openStarrDrop()" style="background:#8e44ad; padding:15px; border-radius:12px; border:none; color:#fff; font-weight:bold; grid-column: span 2;">–°–¢–ê–† –î–†–û–ü (15 üèÜ)</button>
        </div>
        <button onclick="resetGame()" style="background:none; border:none; color:#555; font-size:10px; margin-top:20px;">–°–∫–∏–Ω—É—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å</button>
    </div>

    <style>
        .window { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.98); z-index:100; padding:15px; overflow-y:auto; }
        .content { background:#1a1a1a; padding:15px; border-radius:20px; border:2px solid #ffcc00; text-align:left; }
        .close-btn { background:#ff4444; color:white; border:none; padding:15px; width:100%; border-radius:12px; margin-top:10px; font-weight:bold; cursor:pointer; }
        .opt-btn { background:#333; color:white; border:1px solid #444; padding:12px; width:100%; margin:5px 0; border-radius:8px; display:flex; justify-content:space-between; align-items:center; cursor:pointer; }
        .b-grid { display:grid; grid-template-columns: 1fr 1fr 1fr; gap:8px; }
        .b-card { padding:10px; border-radius:8px; text-align:center; font-size:10px; font-weight:bold; cursor:pointer; border:1px solid rgba(255,255,255,0.1); }
    </style>

    <div id="win-promo" class="window">
        <div class="content">
            <h2>–í–í–ï–î–ò –ü–†–û–ú–û–ö–û–î</h2>
            <input type="text" id="promo-in" placeholder="–ö–û–î..." style="width:90%; padding:15px; background:#333; color:#ffcc00; border:2px solid #ffcc00; border-radius:12px; font-size:18px; font-weight:bold; text-transform:uppercase;">
            <button onclick="usePromo()" class="close-btn" style="background:#2ecc71; margin-top:20px;">–ê–ö–¢–ò–í–£–í–ê–¢–ò</button>
        </div>
        <button onclick="closeWin('win-promo')" class="close-btn">–ó–ê–ö–†–ò–¢–ò</button>
    </div>

    <div id="win-modes" class="window"><div class="content"><h2>–†–ï–ñ–ò–ú–ò</h2>
        <button class="opt-btn" onclick="setMode(1500,'–°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ',false)">üöÄ –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ</button>
        <button class="opt-btn" onclick="setMode(2000,'–ù–æ–∫–∞—É—Ç',false)">‚öîÔ∏è –ù–æ–∫–∞—É—Ç</button>
        <button class="opt-btn" onclick="setMode(10000,'üëë –î–£–ï–õ–¨ (x4)',true)" style="color:red; border:1px solid red;">üëë –î–£–ï–õ–¨</button>
    </div><button onclick="closeWin('win-modes')" class="close-btn">–ó–ê–ö–†–ò–¢–ò</button></div>

    <div id="win-brawlers" class="window">
        <h2 style="color:#ffcc00;">–ë–†–ê–í–õ–ï–†–ò (<span id="b-count">1</span>/99)</h2>
        <div id="brawlers-list" class="b-grid"></div>
        <button onclick="closeWin('win-brawlers')" class="close-btn">–ó–ê–ö–†–ò–¢–ò</button>
    </div>

    <div id="win-shop" class="window"><div class="content"><h2>–ú–ê–ì–ê–ó–ò–ù</h2><div id="shop-items"></div></div><button onclick="closeWin('win-shop')" class="close-btn">–ó–ê–ö–†–ò–¢–ò</button></div>

    <div id="win-profile" class="window"><div class="content"><h2>–ü–†–û–§–Ü–õ–¨</h2>
        <p>–ù–Ü–ö:</p><input type="text" id="nick-in" style="width:90%; padding:10px; background:#333; color:#fff; border-radius:8px;">
        <p>–ó–í–ê–ù–ù–Ø:</p><select id="rank-in" style="width:97%; padding:10px; background:#333; color:#fff; border-radius:8px;"></select>
        <div id="icons-list" style="display:flex; gap:10px; margin-top:10px;"></div>
        <button onclick="saveProfile()" class="close-btn" style="background:#2ecc71;">–ó–ë–ï–†–ï–ì–¢–ò</button>
    </div><button onclick="closeWin('win-profile')" class="close-btn">–ó–ê–ö–†–ò–¢–ò</button></div>

    <div id="win-drop" class="window">
        <h1 id="drop-rarity" style="margin-top:40px; font-size:35px;">RARE</h1>
        <div id="drop-box" onclick="tapDrop()" style="width:180px; height:180px; background:#fff; margin:30px auto; border:8px solid #fff; border-radius:40px; font-size:80px; display:flex; align-items:center; justify-content:center; transition:0.1s; cursor:pointer;">‚≠ê</div>
        <p id="drop-taps" style="font-size:18px;">–¢–ê–ü–ê–ô! (4)</p>
    </div>

    <script>
        // –î–ê–ù–Ü –ì–†–ò
        let trophies = 0, selected = "shelly", curMode = {t:1500, n:'–°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ', isDuel: false};
        let dropData = {taps:0, rarity:0, ultra:false};
        let myRanks = ["–û–¥–∏–Ω–æ–∫–∏–π –≥–æ–Ω—â–∏–∫"], myIcons = ["üë§"], curIcon = "üë§";
        let usedPromos = []; 

        const brawlers = {
            "shelly":{n:"Shelly",r:"rare",ow:true,c:0.55},"nita":{n:"Nita",r:"rare",ow:false,c:0.58},"colt":{n:"Colt",r:"rare",ow:false,c:0.6},"bull":{n:"Bull",r:"rare",ow:false,c:0.59},"brock":{n:"Brock",r:"rare",ow:false,c:0.6},
            "jessie":{n:"Jessie",r:"super_rare",ow:false,c:0.63},"dynamike":{n:"Dynamike",r:"super_rare",ow:false,c:0.65},"rico":{n:"Rico",r:"super_rare",ow:false,c:0.65},
            "edgar":{n:"Edgar",r:"epic",ow:false,c:0.75},"angelo":{n:"Angelo",r:"epic",ow:false,c:0.76},"berry":{n:"Berry",r:"epic",ow:false,c:0.75},"piper":{n:"Piper",r:"epic",ow:false,c:0.72},
            "moe":{n:"Moe",r:"mythic",ow:false,c:0.86},"clancy":{n:"Clancy",r:"mythic",ow:false,c:0.87},"mortis":{n:"Mortis",r:"mythic",ow:false,c:0.78},"max":{n:"Max",r:"mythic",ow:false,c:0.82},
            "kenji":{n:"Kenji",r:"legendary",ow:false,c:0.91},"kit":{n:"Kit",r:"legendary",ow:false,c:0.9},"draco":{n:"Draco",r:"legendary",ow:false,c:0.9},"spike":{n:"Spike",r:"legendary",ow:false,c:0.88},"crow":{n:"Crow",r:"legendary",ow:false,c:0.88},
            "kedzi":{n:"Kedzi",r:"ultra",ow:false,c:0.95}
        };

        const rarities = [
            {n:"RARE",c:"#00ff00",r:5,id:"rare"}, {n:"SUPER RARE",c:"#3498db",r:10,id:"super_rare"},
            {n:"EPIC",c:"#9b59b6",r:20,id:"epic"}, {n:"MYTHIC",c:"#ff0000",r:50,id:"mythic"},
            {n:"LEGENDARY",c:"#f1c40f",r:100,id:"legendary"}, {n:"ULTRA",c:"#ff0000",r:500,id:"ultra"}
        ];

        // –§–£–ù–ö–¶–Ü–á –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
        function saveData() {
            const ownedBrawlers = Object.keys(brawlers).filter(id => brawlers[id].ow);
            const data = { trophies, ownedBrawlers, usedPromos, curIcon, nick: document.getElementById('p-nick').innerText };
            localStorage.setItem('kedzi_brawl_save', JSON.stringify(data));
        }

        function loadData() {
            const saved = localStorage.getItem('kedzi_brawl_save');
            if (saved) {
                const data = JSON.parse(saved);
                trophies = data.trophies || 0;
                usedPromos = data.usedPromos || [];
                curIcon = data.curIcon || "üë§";
                document.getElementById('p-nick').innerText = data.nick || "–ì—Ä–∞–≤–µ—Ü—å";
                document.getElementById('p-icon').innerText = curIcon;
                if (data.ownedBrawlers) {
                    data.ownedBrawlers.forEach(id => { if(brawlers[id]) brawlers[id].ow = true; });
                }
                document.getElementById('trophies').innerText = trophies;
            }
        }

        function resetGame() {
            if(confirm("–°–∫–∏–Ω—É—Ç–∏ –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å?")) {
                localStorage.removeItem('kedzi_brawl_save');
                location.reload();
            }
        }

        // –ü–†–û–ú–û–ö–û–î–ò
        function usePromo() {
            const val = document.getElementById('promo-in').value.toUpperCase();
            if (usedPromos.includes(val)) return alert("‚ùå –í–ñ–ï –í–ò–ö–û–†–ò–°–¢–ê–ù–û!");

            if(val === 'ALPHATEST') {
                trophies += 1000; usedPromos.push(val); alert("üöÄ +1000 üèÜ");
            } else if(val === 'ARTEMKO') {
                trophies += 1100; usedPromos.push(val); alert("üëë +1100 üèÜ");
            } else {
                return alert("‚ùå –ù–ï–í–Ü–†–ù–ò–ô –ö–û–î");
            }
            document.getElementById('trophies').innerText = trophies;
            document.getElementById('promo-in').value = "";
            saveData();
            closeWin('win-promo');
        }

        function openWin(id) { 
            document.getElementById(id).style.display = 'block'; 
            if(id==='win-shop') renderShop();
            if(id==='win-profile') renderProfileOptions();
            if(id==='win-brawlers') renderBrawlers();
        }
        function closeWin(id) { document.getElementById(id).style.display = 'none'; }

        function setMode(time, name, duel) {
            curMode = {t:time, n:name, isDuel:duel};
            document.getElementById('cur-mode-txt').innerText = name;
            document.getElementById('cur-mode-txt').style.color = duel ? "red" : "#00ff00";
            closeWin('win-modes');
        }

        function startBattle() {
            const btn = document.getElementById('play-btn'); btn.disabled = true; btn.innerText = "–£ –ë–û–Æ...";
            setTimeout(() => {
                let win = Math.random() < brawlers[selected].c;
                if (curMode.isDuel) {
                    if (win) { trophies = trophies===0?20:trophies*4; alert("üî• –ü–ï–†–ï–ú–û–ì–ê x4!"); }
                    else { trophies = 0; alert("üíÄ –ö–†–ê–•!"); }
                } else {
                    let rew = win ? 8 : -7; trophies = Math.max(0, trophies + rew);
                    alert(win ? `+${rew} üèÜ` : `${rew} üèÜ`);
                }
                document.getElementById('trophies').innerText = trophies;
                btn.disabled = false; btn.innerText = "–ì–†–ê–¢–ò";
                saveData();
            }, curMode.t);
        }

        function openStarrDrop() {
            if(trophies<15) return alert("–¢—Ä–µ–±–∞ 15üèÜ");
            trophies-=15; document.getElementById('trophies').innerText = trophies;
            dropData = {taps:4, rarity:0, ultra:false}; updateDropUI(); openWin('win-drop');
            saveData();
        }

        function tapDrop() {
            if(dropData.taps > 0) {
                let rnd = Math.random() * 100;
                if(rnd < 5 && !dropData.ultra) { dropData.ultra = true; dropData.rarity = 5; }
                else if(rnd < 30 && dropData.rarity < 4) dropData.rarity++;
                dropData.taps--; updateDropUI();
            } else finishDrop();
        }

        function updateDropUI() {
            const r = rarities[dropData.rarity];
            document.getElementById('win-drop').style.background = dropData.ultra ? "#000" : r.c;
            document.getElementById('drop-rarity').innerText = r.n;
            document.getElementById('drop-taps').innerText = "–¢–ê–ü–ê–ô! (" + dropData.taps + ")";
        }

        function finishDrop() {
            const r = rarities[dropData.rarity];
            let pool = Object.keys(brawlers).filter(id => brawlers[id].r === r.id && !brawlers[id].ow);
            if(pool.length > 0 && Math.random() < 0.4) {
                let won = pool[Math.floor(Math.random()*pool.length)];
                brawlers[won].ow = true; alert("–ù–û–í–ò–ô –ë–†–ê–í–õ–ï–†: " + brawlers[won].n);
            } else {
                trophies += r.r; alert(r.n + "! +" + r.r + " üèÜ");
            }
            document.getElementById('trophies').innerText = trophies; 
            saveData();
            closeWin('win-drop');
        }

        function renderShop() {
            const s = document.getElementById('shop-items'); s.innerHTML = "";
            [{n:'üî•',p:50,t:'i'},{n:'LEGEND',p:1000,t:'r'}].forEach(item => {
                s.innerHTML += `<div class="opt-btn" onclick="buyCos('${item.n}','${item.t}',${item.p})"><span>${item.n}</span> <span>${item.p}üèÜ</span></div>`;
            });
        }

        function buyCos(n,t,p) {
            if(trophies >= p) {
                trophies -= p;
                if(n === 'LEGEND') {
                    let pool = Object.keys(brawlers).filter(id => brawlers[id].r === "legendary" && !brawlers[id].ow);
                    if(pool.length>0) { let b=pool[0]; brawlers[b].ow=true; alert("–õ–ï–ì–ï–ù–î–ê: "+brawlers[b].n); }
                } else { myIcons.push(n); }
                document.getElementById('trophies').innerText = trophies;
                saveData();
            } else alert("–ú–∞–ª–æ –∫—É–±–∫—ñ–≤!");
        }

        function renderProfileOptions() {
            const rIn = document.getElementById('rank-in'); rIn.innerHTML = "<option>–ù–æ–≤–∞—á–æ–∫</option><option>LEGEND</option>";
            const iL = document.getElementById('icons-list'); iL.innerHTML = "";
            myIcons.forEach(i => iL.innerHTML += `<span onclick="curIcon='${i}';saveData()" style="font-size:30px; cursor:pointer;">${i}</span>`);
        }

        function saveProfile() {
            document.getElementById('p-nick').innerText = document.getElementById('nick-in').value || "–ì—Ä–∞–≤–µ—Ü—å";
            document.getElementById('p-icon').innerText = curIcon;
            saveData();
            closeWin('win-profile');
        }

        function renderBrawlers() {
            const l = document.getElementById('brawlers-list'); l.innerHTML = ""; let count = 0;
            const colors = {rare:"#00ff00", super_rare:"#3498db", epic:"#9b59b6", mythic:"#ff0000", legendary:"#f1c40f", ultra:"#fff"};
            for(let id in brawlers) {
                if(brawlers[id].ow) { 
                    count++;
                    l.innerHTML += `<div class="b-card" style="background:${colors[brawlers[id].r]}" onclick="selected='${id}';closeWin('win-brawlers')">${brawlers[id].n}</div>`;
                }
            }
            document.getElementById('b-count').innerText = count;
        }

        // –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –ü–†–ò –°–¢–ê–†–¢–Ü
        window.onload = loadData;
    </script>
</body>
</html>
