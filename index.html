<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KEDZI BRAWL v9.7.5 - STARR DROP FIX</title>
</head>
<body style="margin:0; background:#000; color:#fff; font-family: 'Arial Black', sans-serif; text-align:center; overflow:hidden;">

    <style>
        @keyframes rainbow { 0% { background: #ff0000; } 20% { background: #ffcc00; } 40% { background: #00ff00; } 60% { background: #00ffff; } 80% { background: #0000ff; } 100% { background: #ff00ff; } }
        .rainbow-bg { animation: rainbow 2s infinite linear !important; color: #fff; text-shadow: 1px 1px #000; }
        .window { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.98); z-index:100; padding:15px; overflow-y:auto; }
        .content { background:#1a1a1a; padding:15px; border-radius:20px; border:2px solid #ffcc00; }
        .close-btn { background:#ff4444; color:white; border:none; padding:15px; width:100%; border-radius:12px; margin-top:10px; font-weight:bold; cursor:pointer; }
        .opt-btn { background:#333; color:white; border:1px solid #444; padding:12px; width:100%; margin:5px 0; border-radius:8px; display:flex; justify-content:space-between; align-items:center; cursor:pointer; }
    </style>

    <div onclick="openWin('win-profile')" style="background:#111; padding:12px; display:flex; justify-content:space-between; border-bottom:2px solid #ffcc00; cursor:pointer;">
        <div><span id="p-nick">–ì—Ä–∞–≤–µ—Ü—å</span> üèÜ <span id="trophies">0</span></div>
        <div id="selected-name" style="font-size:10px; color:#aaa;">SHELLY</div>
    </div>

    <div style="padding:20px;">
        <h1 style="color:#ffcc00;">KEDZI BRAWL</h1>
        <div id="cheat-indicator" style="color:#ff00ff; font-size:12px; display:none;">‚ú® –ó–Ü–õ–õ–Ø –ê–ö–¢–ò–í–û–í–ê–ù–ï</div>
        <button onclick="startBattle()" id="play-btn" style="background:#ffcc00; width:100%; padding:20px; font-size:24px; border-radius:20px; font-weight:bold; margin-bottom:15px;">–ì–†–ê–¢–ò</button>
        
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
            <button onclick="openWin('win-modes')" style="background:#2ecc71; padding:15px; border-radius:12px;">–†–ï–ñ–ò–ú–ò</button>
            <button onclick="openWin('win-brawlers')" style="background:#3498db; padding:15px; border-radius:12px;">–ë–†–ê–í–õ–ï–†–ò</button>
            <button onclick="openWin('win-shop')" style="background:#e74c3c; padding:15px; border-radius:12px;">–ú–ê–ì–ê–ó–ò–ù</button>
            <button onclick="openWin('win-promo')" style="background:#f1c40f; padding:15px; border-radius:12px;">–ü–†–û–ú–û</button>
            <button onclick="openStarrDrop()" style="background:#8e44ad; padding:15px; border-radius:12px; grid-column: span 2;">–°–¢–ê–† –î–†–û–ü (15 üèÜ)</button>
        </div>
        <button onclick="openWin('win-changelog')" style="position:fixed; bottom:15px; right:15px; background:#444; color:#ccc; border:none; padding:8px 15px; border-radius:8px; font-size:12px;">CHANGELOG üìú</button>
    </div>

    <div id="win-drop" class="window">
        <h1 id="drop-rarity" style="margin-top:40px; font-size:35px; color:#00ff00;">RARE</h1>
        <div id="drop-box" onclick="tapDrop()" style="width:180px; height:180px; background:#fff; margin:30px auto; border:8px solid #fff; border-radius:40px; font-size:80px; display:flex; align-items:center; justify-content:center; cursor:pointer; transition: 0.1s;">‚≠ê</div>
        <p id="drop-taps" style="font-size:20px;">–¢–ê–ü–ê–ô! (4)</p>
    </div>

    <div id="win-changelog" class="window"><div class="content"><h2 style="color:#ffcc00;">CHANGELOG</h2>‚Ä¢ v9.7.5: –°–¢–ê–† –î–†–û–ü–ò –ü–û–§–Ü–ö–®–ï–ù–û!<br>‚Ä¢ –¢–µ–ø–µ—Ä –≤–æ–Ω–∏ –∑–Ω–æ–≤—É –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å—Å—è.<br>‚Ä¢ Ultra Kedzi —à–∞–Ω—Å 1.5%.</div><button onclick="closeWin('win-changelog')" class="close-btn">–ó–ê–ö–†–ò–¢–ò</button></div>

    <div id="win-modes" class="window"><div class="content"><h2>–†–ï–ñ–ò–ú–ò</h2><button class="opt-btn" onclick="setMode(1500,'–°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ',false,false)">üöÄ –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ</button><button class="opt-btn" onclick="setMode(2500,'üî• –ù–û–ö–ê–£–¢',false,false)">üî• –ù–û–ö–ê–£–¢</button><button class="opt-btn" onclick="setMode(1500,'‚öΩ –ë–†–ê–í–õ –ë–û–õ',false,true)">‚öΩ –ë–†–ê–í–õ –ë–û–õ</button></div><button onclick="closeWin('win-modes')" class="close-btn">–ó–ê–ö–†–ò–¢–ò</button></div>
    <div id="win-shop" class="window"><div class="content"><h2>–ú–ê–ì–ê–ó–ò–ù</h2><div id="shop-items"></div></div><button onclick="closeWin('win-shop')" class="close-btn">–ó–ê–ö–†–ò–¢–ò</button></div>
    <div id="win-brawlers" class="window"><h2 style="color:#ffcc00;">–ë–†–ê–í–õ–ï–†–ò</h2><div id="brawlers-list" style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px;"></div><button onclick="closeWin('win-brawlers')" class="close-btn">–ó–ê–ö–†–ò–¢–ò</button></div>
    <div id="win-promo" class="window"><div class="content"><h2>–ü–†–û–ú–û–ö–û–î</h2><input type="text" id="promo-in" style="width:90%; padding:10px;"><button onclick="usePromo()" class="close-btn" style="background:#2ecc71;">OK</button></div><button onclick="closeWin('win-promo')" class="close-btn">–ó–ê–ö–†–ò–¢–ò</button></div>

    <script>
        let trophies = 0, selected = "shelly", curMode = {t:1500, n:'–°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ', isDuel: false, isBall: false};
        let usedPromos = [], cheatActive = false, hasCheatPotion = false;
        let dropData = { taps: 4, rarityIdx: 0 };
        
        const brawlers = {
            "shelly":{n:"Shelly",r:"rare",ow:true,c:0.55},"nita":{n:"Nita",r:"rare",ow:false,c:0.58},"colt":{n:"Colt",r:"rare",ow:false,c:0.6},
            "edgar":{n:"Edgar",r:"epic",ow:false,c:0.75},"moe":{n:"Moe",r:"mythic",ow:false,c:0.86},
            "kenji":{n:"Kenji",r:"legendary",ow:false,c:0.91},"kedzi":{n:"Kedzi",r:"ultra",ow:false,c:0.95}
        };

        const rarities = [
            {n:"RARE", c:"#00ff00"}, {n:"SUPER RARE", c:"#3498db"}, 
            {n:"EPIC", c:"#9b59b6"}, {n:"MYTHIC", c:"#ff0000"}, 
            {n:"LEGENDARY", c:"#f1c40f"}, {n:"ULTRA", c:"#ffffff"}
        ];

        // –§–£–ù–ö–¶–Ü–Ø –°–¢–ê–† –î–†–û–ü–£
        function openStarrDrop() {
            if (trophies >= 15) {
                trophies -= 15;
                dropData = { taps: 4, rarityIdx: 0 };
                updateDropUI();
                openWin('win-drop');
                updateUI();
            } else alert("–¢—Ä–µ–±–∞ 15 üèÜ!");
        }

        function tapDrop() {
            if (dropData.taps > 1) {
                dropData.taps--;
                // –®–∞–Ω—Å –Ω–∞ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è —Ä—ñ–¥–∫—ñ—Å–Ω–æ—Å—Ç—ñ –ø—Ä–∏ —Ç–∞–ø—ñ
                if (Math.random() < 0.4) {
                    dropData.rarityIdx = Math.min(dropData.rarityIdx + 1, (Math.random() < 0.015 ? 5 : 4));
                }
                updateDropUI();
                // –ï—Ñ–µ–∫—Ç —Ç—Ä—è—Å–∫–∏
                document.getElementById('drop-box').style.transform = "scale(1.1)";
                setTimeout(() => document.getElementById('drop-box').style.transform = "scale(1)", 100);
            } else {
                finishDrop();
            }
        }

        function updateDropUI() {
            const r = rarities[dropData.rarityIdx];
            document.getElementById('drop-rarity').innerText = r.n;
            document.getElementById('drop-rarity').style.color = r.c;
            document.getElementById('drop-box').style.borderColor = r.c;
            document.getElementById('drop-taps').innerText = `–¢–ê–ü–ê–ô! (${dropData.taps})`;
            if (r.n === "ULTRA") document.getElementById('drop-box').className = "rainbow-bg";
            else document.getElementById('drop-box').className = "";
        }

        function finishDrop() {
            let r = rarities[dropData.rarityIdx].n;
            let rewardMsg = "";
            
            if (r === "ULTRA" || r === "LEGENDARY" || (r === "MYTHIC" && Math.random() < 0.3)) {
                // –í–∏–ø–∞–¥–∫–æ–≤–∏–π –∑–∞–∫—Ä–∏—Ç–∏–π –±—Ä–∞–≤–ª–µ—Ä
                let locked = Object.keys(brawlers).filter(id => !brawlers[id].ow);
                if (locked.length > 0) {
                    let bId = locked[Math.floor(Math.random() * locked.length)];
                    brawlers[bId].ow = true;
                    rewardMsg = `–ù–û–í–ò–ô –ë–†–ê–í–õ–ï–†: ${brawlers[bId].n}!`;
                } else { rewardMsg = "+500 üèÜ (–≤—Å—ñ –≥–µ—Ä–æ—ó –≤–∂–µ —î)"; trophies += 500; }
            } else {
                let bonus = (dropData.rarityIdx + 1) * 20;
                trophies += bonus;
                rewardMsg = `+${bonus} üèÜ`;
            }
            
            alert(`–°–¢–ê–† –î–†–û–ü: ${r}!\n–ù–∞–≥–æ—Ä–æ–¥–∞: ${rewardMsg}`);
            closeWin('win-drop');
            saveData();
            updateUI();
        }

        // –†–ï–®–¢–ê –§–£–ù–ö–¶–Ü–ô
        function updateUI() { 
            document.getElementById('trophies').innerText = trophies; 
            document.getElementById('selected-name').innerText = brawlers[selected].n.toUpperCase();
            document.getElementById('cheat-indicator').style.display = cheatActive ? 'block' : 'none';
        }
        function openWin(id) { document.getElementById(id).style.display = 'block'; if(id==='win-brawlers') renderBrawlers(); }
        function closeWin(id) { document.getElementById(id).style.display = 'none'; }
        function saveData() { localStorage.setItem('kedzi_brawl_save', JSON.stringify({ trophies, usedPromos, selected, cheatActive, hasCheatPotion, owned: Object.keys(brawlers).filter(id => brawlers[id].ow), nick: document.getElementById('p-nick').innerText })); }
        function loadData() { 
            let s = JSON.parse(localStorage.getItem('kedzi_brawl_save')); 
            if(s){ trophies=s.trophies; usedPromos=s.usedPromos; selected=s.selected; cheatActive=s.cheatActive; hasCheatPotion=s.hasCheatPotion; if(s.owned) s.owned.forEach(id=>brawlers[id].ow=true); document.getElementById('p-nick').innerText=s.nick; updateUI(); }
        }
        function renderBrawlers() {
            const l = document.getElementById('brawlers-list'); l.innerHTML = "";
            for(let id in brawlers) if(brawlers[id].ow) l.innerHTML += `<div onclick="selected='${id}';updateUI();closeWin('win-brawlers');saveData();" style="background:#444;padding:10px;border-radius:8px;">${brawlers[id].n}</div>`;
        }
        function startBattle() { /* –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –¥–æ v9.7.4 */ }
        window.onload = loadData;
    </script>
</body>
</html>
